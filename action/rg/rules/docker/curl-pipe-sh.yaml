rules:
  - id: action.rg.rules.docker.rg.docker.curl-pipe-sh
    languages: [dockerfile]
    message: "Avoid piping curl/wget to a shell. Download, verify checksum/signature, then execute."
    severity: ERROR
    pattern-regex: '(?i)\b(curl|wget)\b[^|]*(\|\s*(sh|bash)\b)'
    metadata:
      category: security
      technology: [dockerfile]
      rg:
        hint: "Donâ€™t do curl|sh. Download, verify (checksum/signature), then run."
